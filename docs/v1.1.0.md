# Version 1.1.0

## 主要變更

### TypeScript 重構

- 將整個項目從 JavaScript 重構為 TypeScript
- 新增完整的類型安全支持
- 改善開發體驗和代碼質量

### 技術改進

- 使用 TypeScript 5.7.2
- 配置了完整的 TypeScript 編譯環境
- 更新了測試配置以支持 TypeScript
- 自動生成類型定義文件

### 構建系統

- 新增 `pnpm build` 命令進行 TypeScript 編譯
- 輸出文件移至 `dist/` 目錄
- 保持向後兼容性

### 文件結構變更

```
src/
├── index.ts        # 主要功能（TypeScript）
dist/
├── index.js        # 編譯後的 JavaScript
├── index.d.ts      # 類型定義文件
test/
├── index.test.ts   # 測試文件（TypeScript）
```

### 升級指南

對於使用者來說，API 保持完全不變。只需要確保使用最新版本：

```bash
pnpm install @solitango/rehype-chinese-punctuation-compression@^1.1.0
```

### 開發者注意事項

如果您要貢獻代碼：

1. 現在需要運行 `pnpm build` 來編譯 TypeScript
2. 所有新功能都應該用 TypeScript 編寫
3. 測試文件現在是 `.ts` 格式

## 功能保持不變

所有現有功能保持完全一致：

- 中文標點符號擠壓邏輯
- API 接口
- 使用方式
- 輸出格式

此文檔描述 `rehype-chinese-punctutation-compression` 在 v1.1.0 需要完成的目標、對其的註釋以及實現方法。

在必要時，請記錄後續版本需要注意之事項。

## 主要目標

在 v1.1.0，需要在 v1.0.0 功能之基礎上，新增對橫排簡體中文之標點擠壓功能，其具體為：

1. `[]` 為 rehype 插件新增插件配置之功能，其暫時默認只有一個選項 `scriptSystem`，其只有 `traditional` 和 `simplified` 兩個值，分別對應繁體中文和簡體中文。若用戶未設置該值，則自動回落至 `traditional`。
2. `[]` 根據插件之配置，實現對應的標點擠壓功能。實際上標點擠壓之算法於 v1.0.0 一致，但需要注意簡／繁體之標點集不同。
   其中，繁體中文的標點擠壓已經在 v1.0.0 中實現。
3. `[]` 新增對簡體中文的測試，其樣式類似 v1.0.0 中的測試，並分別為簡體和繁體中文建立獨立的測試文件。

在完成任務後，請將上文中的 `[]` 改為 `[x]`。

## 釋義

### 標點集

指可壓縮標點的類型集合，其包含一類具有共同位置的標點。標點集分為三種類型，分別對應靠左、靠中和靠右標點。在簡體和繁體中文中，標點集之組成不盡相同，即其標點靠向不全相同。

標點集的設計是為了在保持現有標點擠壓算法之基礎上，注入標點靠向的依賴，這樣一來便可以輕鬆切換簡／繁體中文之標點擠壓規則。

### 簡體中文中標點符號之類型

在標點擠壓之流程中，標點符號可分為可擠壓和不可擠壓兩種。

其中，問號 `？` 和感歎號 `！` 不可被擠壓，其固定佔用一個字寬。

可擠壓的標點符號又可以分為：

- 靠左標點：逗號 `，`、句號 `。`、頓號 `、`、冒號 `：`、分號`；`、關引號 `」` 和 `』`、關括號 `）` 和關書名號 `》`；
- 靠右標點：開引號 `「` 和 `『`、開括號 `（` 和開書名號 `《`；
- 靠中標點：間隔號 `．`。

值得注意的是，對比繁體中文，簡體中文中除間隔號外之其他靠中標點皆移至靠左標點。

## 實現方法

### 插件配置

插件新增配置選項以支持不同書寫系統：

#### `scriptSystem`

- **類型**：`'traditional' | 'simplified'`
- **默認值**：`'traditional'`
- **效果**：
  - `'traditional'`：使用繁體中文標點集進行標點擠壓
  - `'simplified'`：使用簡體中文標點集進行標點擠壓

當用戶未指定該配置項時，插件自動回落至 `'traditional'`，以保持向後兼容性。

### 標點集實現

根據 `scriptSystem` 配置，插件將選擇對應的標點集：

```
若 scriptSystem === 'traditional'，則使用繁體中文標點集；
若 scriptSystem === 'simplified'，則使用簡體中文標點集。
```

標點擠壓算法保持與 v1.0.0 一致，僅根據不同標點集調整標點符號之靠向判斷。
